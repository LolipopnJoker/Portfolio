# bar plot
w <- rowsum(tdm)
library(tidyverse) # Importing tidyverse
library(tm)
DB  <- read.csv('G:/My Drive/Portfolio/R/Project_1/dataset.csv', row.names = 1) # Importing the data.
# Splitting the date column
DB <- separate(DB, Release.Date, c("release.month", "release.day", "release.year"), sep = " ")
DB <- separate(DB, Genre, c("Genre.1", "Genre.2", "Genre.3", "Genre.4", "Genre.5", "Genre.6"), sep = ", ")
# Cleaning from unwanted symbols that might affect the analysis.
DB[] <- lapply(DB, gsub, pattern=',', replacement='') # Deleting all the , symbols.
DB[] <- lapply(DB, gsub, pattern="'", replacement='') # Deleting all the ' symbols.
DB[] <- lapply(DB, gsub, pattern='\\[', replacement='') # Deleting all the [ symbols.
DB[] <- lapply(DB, gsub, pattern='\\]', replacement='') # Deleting all the ] symbols.
worldwide_sales_mean <- mean(as.numeric(DB$World.Sales..in...), na.rm = TRUE)
worldwide_sales_sd <- sd(as.numeric(DB$World.Sales..in...), na.rm = TRUE)
corpus <- iconv(DB$Movie.Info, to = "utf-8")
corpus <- Corpus(VectorSource(corpus))
## Further cleaning for the Sentiment Analysis
corpus <- tm_map(corpus, tolower)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
clean_set <- tm_map(corpus, removeWords, stopwords('english'))
clean_set <- tm_map(clean_set, stripWhitespace)
## Term document matrix
tdm <-  TermDocumentMatrix(clean_set)
# bar plot
w <- rowsum(tdm)
# bar plot
w <- rowSums(tdm)
tdm <- as.matrix(tdm)
# bar plot
w <- rowSums(tdm)
w <- subset(w, w>=25)
ggplot(aes(w))+
geom_bar(color="black")
ggplot(aes(w))+
geom_histogram(color="black")
w
w <- as.list(w)
ggplot(aes(w))+
geom_histogram(color="black")
w <- as.matrix(w)
ggplot(aes(w))+
geom_histogram(color="black")
w <- as.data.frame(w)
ggplot(aes(w))+
geom_histogram(color="black")
View(w)
ggplot(aes(w$V1))+
geom_histogram(color="black")
w <- as.data.frame(w)
ggplot(aes(w$V1))+
geom_histogram(color="black")
ggplot(w, aes(w$V1))+
geom_histogram(color="black")
ggplot(w, aes(V1))+
geom_histogram(color="black")
ggplot(w, aes(V1))+
geom_histogram(color="black", binwidth = 3)
ggplot(w, aes(V1))+
geom_histogram(color="black", binwidth = 0.3)
# bar plot
w <- rowSums(tdm)
w <- subset(w, w>=50)
w <- as.data.frame(w)
ggplot(w, aes(V1))+
geom_histogram(color="black", binwidth = 0.3)
ggplot(w, aes(w))+
geom_histogram(color="black", binwidth = 0.3)
View(w)
ggplot(w, aes(y=w))+
geom_histogram(color="black", binwidth = 0.3)
install.packages('syuzhet')
library(lubridate)
library(scales)
library(reshape2)
library(syuzhet)
# Obtain sentinent score
s <- get_nrc_sentiment(corpus)
corpus <- iconv(DB$Movie.Info, to = "utf-8")
# Obtain sentinent score
s <- get_nrc_sentiment(corpus)
s
View(s)
full_DB <- merge(DB, s)
View(full_DB)
View(full_DB)
full_DB <- full_join(DB, s)
full_DB <- cbind(DB, s)
View(full_DB)
library(tidyverse) # Importing tidyverse
library(tm)
library(syuzhet)
DB  <- read.csv('G:/My Drive/Portfolio/R/Project_1/dataset.csv', row.names = 1) # Importing the data.
# Splitting the date column
DB <- separate(DB, Release.Date, c("release.month", "release.day", "release.year"), sep = " ")
DB <- separate(DB, Genre, c("Genre.1", "Genre.2", "Genre.3", "Genre.4", "Genre.5", "Genre.6"), sep = ", ")
# Cleaning from unwanted symbols that might affect the analysis.
DB[] <- lapply(DB, gsub, pattern=',', replacement='') # Deleting all the , symbols.
DB[] <- lapply(DB, gsub, pattern="'", replacement='') # Deleting all the ' symbols.
DB[] <- lapply(DB, gsub, pattern='\\[', replacement='') # Deleting all the [ symbols.
DB[] <- lapply(DB, gsub, pattern='\\]', replacement='') # Deleting all the ] symbols.
worldwide_sales_mean <- mean(as.numeric(DB$World.Sales..in...), na.rm = TRUE)
worldwide_sales_sd <- sd(as.numeric(DB$World.Sales..in...), na.rm = TRUE)
corpus <- iconv(DB$Movie.Info, to = "utf-8") # Creating a list with all the movie descriptions
## Obtain sentiment score
sentiment_score_DF <- get_nrc_sentiment(corpus) # Creating a dataframe with sentiment scores.
full_DB <- cbind(DB, sentiment_score_DF) # Merging the dataframes
linear_model <- lm(full_DB$World.Sales..in..., full_DB$anger)
linear_model <- lm(full_DB$World.Sales..in...~full_DB$anger)
linear_model
summary(linear_model)
linear_model <- lm(full_DB$World.Sales..in...~full_DB$anger+full_DB$anticipation+
full_DB$disgust)
linear_model
summary(linear_model)
linear_model <- lm(full_DB$World.Sales..in...~full_DB$anger+full_DB$anticipation+
full_DB$disgust+full_DB$fear)
linear_model
summary(linear_model)
linear_model <- lm(full_DB$World.Sales..in...~full_DB$anger+full_DB$anticipation+
full_DB$disgust+full_DB$fear+full_DB$joy+full_DB$sadness+
full_DB$surprise+full_DB$trust+full_DB$negative+full_DB$positive)
summary(linear_model)
library(tidyverse) # Importing tidyverse
library(tm) # Importing tm
library(syuzhet) # Importing syuzhet
DB  <- read.csv('G:/My Drive/Portfolio/R/Project_1/dataset.csv', row.names = 1) # Importing the data.
# Splitting the date column
DB <- separate(DB, Release.Date, c("release.month", "release.day", "release.year"), sep = " ")
DB <- separate(DB, Genre, c("Genre.1", "Genre.2", "Genre.3", "Genre.4", "Genre.5", "Genre.6"), sep = ", ")
# Cleaning from unwanted symbols that might affect the analysis.
tm_map(DB, removePunctuation)
# Cleaning from unwanted symbols that might affect the analysis.
tm_map(DB$release.month, removePunctuation)
View(DB)
